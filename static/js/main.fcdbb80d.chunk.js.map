{"version":3,"sources":["../../src/components/ScrollSpyProvider.tsx","../../src/components/ScrollSpyComponent.tsx","../../src/components/ScrollSpyTopic.tsx","components/Navbar.js","App.js","index.js"],"names":["ScrollSpyContext","React","ScrollSpyActions","ScrollSpyProvider","options","threshold","currentObserver","window","entries","entry","setNodes","nodes","n","isActive","current","state","sortedNodeTree","item","parentObj","obj","arr","actions","addNode","topic","id","instance","parent","parentTopic","value","ScrollSpyComponent","rest","context","Error","useScrollSpy","ref","inheritedTopic","childrenWithTopic","child","renderArr","map","node","key","style","display","fontWeight","color","href","title","Navbar","useScrollSpyState","className","Object","keys","Array","isArray","nestedTopic","some","ExampleContent","children","background","height","App","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.fcdbb80d.chunk.js","sourcesContent":["import React from 'react'\n\ninterface ScrollSpyRef {\n  title: string\n  topic?: string\n  parentTopic?: string\n}\n\ninterface ScrollItem {\n  title: string\n  id: string\n  isActive: boolean\n  topic?: string\n  parent?: string\n}\n\ninterface Tree {\n  unsorted: ScrollItem[]\n  [key: string]: any\n}\n\ninterface ScrollSpyState {\n  nodes: ScrollItem[]\n  sortedNodeTree: Tree\n}\n\ninterface ScrollSpyProviderProps {\n  children?: React.ReactNode\n\n  // The threshold is a number from 0-1 indicating how much the child should be\n  // in view before becoming the current node\n  threshold?: number\n  options?: IntersectionObserverInit\n}\n\ninterface ScrollSpyActions {\n  addNode: (instance: HTMLDivElement | null, options: ScrollSpyRef) => void\n}\n\nconst ScrollSpyContext = React.createContext<ScrollSpyState | undefined>(\n  undefined\n)\n\nconst ScrollSpyActions = React.createContext<ScrollSpyActions | undefined>(\n  undefined\n)\n\nexport default function ScrollSpyProvider({\n  children,\n  options = { threshold: 0.5 }\n}: ScrollSpyProviderProps) {\n  const [nodes, setNodes] = React.useState<ScrollItem[]>([])\n\n  // We want the IntersectionObserver inside a useRef because it will\n  // not trigger a rerender unlike useState\n  const { current: currentObserver } = React.useRef(\n    new window.IntersectionObserver((entries) => {\n      entries.forEach((entry) => {\n        // If the entry past the threshold, set it as the current node\n        if (entry.intersectionRatio > (options.threshold || 0.5)) {\n          // This may not work on older browsers, but pushState doesnt\n          // trigger a hashchange which would cause a jumping\n          window.history.pushState(null, '', `#${entry.target.id}`)\n\n          // Update node that is currently past the threshold\n          setNodes((nodes) =>\n            nodes.map((n) =>\n              n.id === entry.target.id\n                ? { ...n, isActive: true }\n                : { ...n, isActive: false }\n            )\n          )\n        }\n      })\n    }, options)\n  )\n\n  // We need to seperate the state from the actions because we dont want\n  // addNode to update everytime currentNode or nodes updates\n  const state = React.useMemo(\n    () => ({\n      nodes,\n      // This tree implementation is a little complex, but it consolidate repeated\n      // topics and supports up to 2 levels of depth\n      sortedNodeTree: nodes.reduce((obj: any, item) => {\n        if (item.parent) {\n          const parentObj = obj[item.parent] || {}\n          const arr = parentObj[item.topic || 'unsorted'] || []\n          return {\n            ...obj,\n            [item.parent]: {\n              ...parentObj,\n              [item.topic || 'unsorted']: [...arr, item]\n            }\n          }\n        } else {\n          const arr = obj[item.topic || 'unsorted'] || []\n          return {\n            ...obj,\n            [item.topic || 'unsorted']: [...arr, item]\n          }\n        }\n      }, {})\n    }),\n    [nodes]\n  )\n\n  // We memorize the state & actions to prevent occasional unnecessary rerenders\n  const actions = React.useMemo(\n    () => ({\n      // Because we can pass in a function as a 'ref' we can use this function\n      // to add the node to the observer 'tree'\n      addNode: (\n        instance: HTMLDivElement | null,\n        { title, parentTopic, topic }: ScrollSpyRef\n      ): void => {\n        if (instance) {\n          currentObserver.observe(instance)\n\n          setNodes((nodes) => [\n            ...nodes,\n            {\n              title,\n              id: instance.id,\n              isActive: false,\n              topic,\n              parent: parentTopic\n            }\n          ])\n        }\n      }\n    }),\n    [currentObserver]\n  )\n\n  // Cleanup\n  React.useEffect(() => {\n    return () => currentObserver.disconnect()\n  }, [currentObserver])\n\n  return (\n    <ScrollSpyContext.Provider value={state}>\n      <ScrollSpyActions.Provider value={actions}>\n        {children}\n      </ScrollSpyActions.Provider>\n    </ScrollSpyContext.Provider>\n  )\n}\n\nexport const useScrollSpy = () => {\n  const context = React.useContext(ScrollSpyActions)\n  if (!context) {\n    throw new Error('useScrollSpy must be used within the ScrollSpyProvider')\n  }\n\n  return context.addNode\n}\n\nexport const useScrollSpyState = () => {\n  const context = React.useContext(ScrollSpyContext)\n  if (!context) {\n    throw new Error(\n      'useScrollSpyState must be used within the ScrollSpyProvider'\n    )\n  }\n\n  return context\n}\n","import React from 'react'\nimport { useScrollSpy } from './ScrollSpyProvider'\n\ninterface ScrollSpyComponentProps\n  extends React.DetailedHTMLProps<\n    React.HTMLAttributes<HTMLDivElement>,\n    HTMLDivElement\n  > {\n  children?: React.ReactNode\n  title: string\n  id: string\n  inheritedTopic?: string\n  parentTopic?: string\n}\n\nexport default function ScrollSpyComponent({\n  children,\n  title,\n  id,\n  inheritedTopic,\n  parentTopic,\n  ...rest\n}: ScrollSpyComponentProps) {\n  const addNode = useScrollSpy()\n\n  // Because the IntersectionObserver passes back a DOM node, not a\n  // react one, we need to forward the data-title to pick back up in state\n  return (\n    <div\n      id={id}\n      ref={(instance) =>\n        addNode(instance, { title, topic: inheritedTopic, parentTopic })\n      }\n      {...rest}\n    >\n      {children}\n    </div>\n  )\n}\n","import React from 'react'\n\ninterface ScrollSpyComponentProps\n  extends React.DetailedHTMLProps<\n    React.HTMLAttributes<HTMLDivElement>,\n    HTMLDivElement\n  > {\n  children?: React.ReactNode\n  title: string\n  id: string\n  inheritedTopic?: string\n  parentTopic?: string\n}\n\ninterface ScrollSpyTopicProps {\n  children?: React.ReactNode\n  topic: string\n  inheritedTopic?: string\n}\n\nexport default React.memo(function ScrollSpyTopic({\n  children,\n  topic,\n  inheritedTopic\n}: ScrollSpyTopicProps) {\n  const childrenWithTopic = React.Children.map(children, (child) => {\n    if (!React.isValidElement<ScrollSpyComponentProps>(child)) {\n      return child\n    }\n    return React.cloneElement(child, {\n      inheritedTopic: topic,\n      parentTopic: inheritedTopic\n    })\n  })\n\n  return <div>{childrenWithTopic}</div>\n})\n","import React from 'react'\nimport { useScrollSpyState } from 'scroll-spy'\n\nfunction renderArr(arr) {\n  return arr.map((node) => {\n    return (\n      <li key={node.id}>\n        <a\n          style={{\n            display: 'block',\n            fontWeight: node.isActive ? 'bold' : 'normal',\n            color: node.isActive ? 'var(--color-fuchsia)' : '#5850ec'\n          }}\n          href={`#${node.id}`}\n        >\n          {node.title}\n        </a>\n      </li>\n    )\n  })\n}\n\n// This is a simple implementation of ScrollSpy\nexport default function Navbar() {\n  const { sortedNodeTree } = useScrollSpyState()\n\n  return (\n    <div className='navbar-container'>\n      <ul>\n        {Object.keys(sortedNodeTree).map((topic) => {\n          // This is all of the unsorted arrays, first layer of arrays\n          if (Array.isArray(sortedNodeTree[topic])) {\n            return renderArr(sortedNodeTree[topic])\n          } else {\n            // We then rendering the parent and topic\n            return (\n              <div key={topic}>\n                <h2>{topic}</h2>\n                {Object.keys(sortedNodeTree[topic]).map((nestedTopic) => {\n                  return (\n                    <ul key={nestedTopic}>\n                      {nestedTopic !== 'unsorted' && (\n                        <h3\n                          style={{\n                            fontWeight: sortedNodeTree[topic][nestedTopic].some(\n                              (n) => n.isActive\n                            )\n                              ? 'bold'\n                              : 'normal'\n                          }}\n                        >\n                          {nestedTopic}\n                        </h3>\n                      )}\n                      {renderArr(sortedNodeTree[topic][nestedTopic])}\n                    </ul>\n                  )\n                })}\n              </div>\n            )\n          }\n        })}\n      </ul>\n    </div>\n  )\n}\n","import React from 'react'\nimport {\n  ScrollSpyProvider,\n  ScrollSpyComponent,\n  ScrollSpyTopic\n} from 'scroll-spy'\nimport Navbar from './components/Navbar'\nimport './App.css'\n\nconst ExampleContent = ({ children, color }) => (\n  <div style={{ background: `var(--color-${color})`, height: '100vh' }}>\n    <h1>{children}</h1>\n  </div>\n)\n\nfunction App() {\n  return (\n    <ScrollSpyProvider>\n      <Navbar />\n      <ScrollSpyTopic topic='Introduction'>\n        <ScrollSpyTopic topic='Prepare'>\n          <ScrollSpyComponent\n            id='get-your-supplies'\n            title='Get your supplies ready'\n          >\n            <ExampleContent color='navy'>\n              Get your supplies ready\n            </ExampleContent>\n          </ScrollSpyComponent>\n          <ScrollSpyComponent id='watch-mars-base' title='Watch: Mars Base'>\n            <ExampleContent color='blue'>Watch this video</ExampleContent>\n          </ScrollSpyComponent>\n          <ScrollSpyComponent id='read-space-suits' title='Read space suits'>\n            <ExampleContent color='aqua'>Read space suits</ExampleContent>\n          </ScrollSpyComponent>\n        </ScrollSpyTopic>\n        <ScrollSpyTopic topic='Design your repair kit'>\n          <ScrollSpyComponent\n            id='gather-materials'\n            title='Gather your materials'\n          >\n            <ExampleContent color='teal'>Gather your materials</ExampleContent>\n          </ScrollSpyComponent>\n        </ScrollSpyTopic>\n      </ScrollSpyTopic>\n    </ScrollSpyProvider>\n  )\n}\n\nexport default App\n","import './index.css'\n\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}